# 实验报告: weekly_bull_v5_20260213_020752_034069

**生成时间**: 2026-02-13 02:09:07

## 1. 实验概要

| 项目 | 值 |
|------|------|
| 实验名称 | weekly_bull_v5 |
| 描述 | 全面优化版多头 v5：directional标签, purge, 特征选择, 全特征集 |
| 标签 | ['weekly', 'bull', 'binary', 'v5', 'optimized'] |
| Git Commit | 85a1ee5 |
| Git Branch | main |
| 耗时 | Nones |
| 随机种子 | 42 |

## 2. 数据配置

- **数据源**: binance
- **交易对**: BTCUSDT
- **周期**: 1d
- **时间范围**: 2018-01-01 ~ 2025-12-31
- **数据文件**: `data/raw/btc_binance_BTCUSDT_1d.csv`

## 3. 特征配置

- **特征集**: ['technical', 'volume', 'flow', 'sentiment', 'onchain', 'market_structure', 'lag_rolling']
- **总特征数**: 40
- **NaN处理**: ffill_then_drop

## 4. 标签配置

- **策略**: directional
- **窗口 T**: 7 天
- **阈值 X**: 0.05 (5%)

## 5. 模型配置

- **类型**: lightgbm
- **参数**:
  - n_estimators: 800
  - max_depth: 5
  - learning_rate: 0.05
  - num_leaves: 24
  - subsample: 0.8
  - colsample_bytree: 0.7
  - min_child_samples: 30
  - reg_alpha: 0.2
  - reg_lambda: 0.2
  - random_state: 42
  - verbose: -1
  - min_split_gain: 0.005
  - auto_scale_pos_weight: True

## 6. 评估结果（汇总）

| 指标               |      值 |
|:-----------------|-------:|
| accuracy         | 0.7137 |
| f1_binary        | 0.2092 |
| precision_binary | 0.2509 |
| recall_binary    | 0.1794 |
| f1_macro         | 0.5172 |
| cohen_kappa      | 0.0403 |

## 7. Walk-Forward Fold 详情

- **方法**: walk_forward
- **初始训练集**: 1500
- **OOS窗口**: 63
- **步进**: 21
- **总 Fold 数**: 57

|   fold_id |   train_size |   test_size |   accuracy |   f1_binary |   precision_binary |   recall_binary |   f1_macro |   cohen_kappa |
|----------:|-------------:|------------:|-----------:|------------:|-------------------:|----------------:|-----------:|--------------:|
|    0.0000 |    1500.0000 |     63.0000 |     0.7937 |      0.4800 |             0.3750 |          0.6667 |     0.6756 |        0.3636 |
|    1.0000 |    1521.0000 |     63.0000 |     0.7619 |      0.4000 |             0.2778 |          0.7143 |     0.6257 |        0.2857 |
|    2.0000 |    1542.0000 |     63.0000 |     0.8413 |      0.4444 |             0.3636 |          0.5714 |     0.6759 |        0.3571 |
|    3.0000 |    1563.0000 |     63.0000 |     0.7460 |      0.0000 |             0.0000 |          0.0000 |     0.4273 |       -0.1429 |
|    4.0000 |    1584.0000 |     63.0000 |     0.7143 |      0.1000 |             0.3333 |          0.0588 |     0.4651 |        0.0207 |
|    5.0000 |    1605.0000 |     63.0000 |     0.5873 |      0.0714 |             0.2000 |          0.0435 |     0.4031 |       -0.0678 |
|    6.0000 |    1626.0000 |     63.0000 |     0.6190 |      0.0769 |             1.0000 |          0.0400 |     0.4185 |        0.0479 |
|    7.0000 |    1647.0000 |     63.0000 |     0.6825 |      0.2857 |             0.4444 |          0.2105 |     0.5408 |        0.1139 |
|    8.0000 |    1668.0000 |     63.0000 |     0.6349 |      0.0800 |             0.2500 |          0.0476 |     0.4261 |       -0.0299 |
|    9.0000 |    1689.0000 |     63.0000 |     0.7619 |      0.0000 |             0.0000 |          0.0000 |     0.4324 |       -0.0582 |
|   10.0000 |    1710.0000 |     63.0000 |     0.8413 |      0.0000 |             0.0000 |          0.0000 |     0.4569 |       -0.0294 |
|   11.0000 |    1731.0000 |     63.0000 |     0.8730 |      0.2000 |             0.5000 |          0.1250 |     0.5655 |        0.1572 |
|   12.0000 |    1752.0000 |     63.0000 |     0.8571 |      0.0000 |             0.0000 |          0.0000 |     0.4615 |        0.0000 |
|   13.0000 |    1773.0000 |     63.0000 |     0.8254 |      0.0000 |             0.0000 |          0.0000 |     0.4522 |       -0.0548 |
|   14.0000 |    1794.0000 |     63.0000 |     0.8571 |      0.0000 |             0.0000 |          0.0000 |     0.4615 |       -0.0519 |
|   15.0000 |    1815.0000 |     63.0000 |     0.9048 |      0.0000 |             0.0000 |          0.0000 |     0.4750 |       -0.0500 |
|   16.0000 |    1836.0000 |     63.0000 |     0.7619 |      0.1176 |             0.0833 |          0.2000 |     0.4900 |        0.0063 |
|   17.0000 |    1857.0000 |     63.0000 |     0.6349 |      0.2069 |             0.2308 |          0.1875 |     0.4849 |       -0.0269 |
|   18.0000 |    1878.0000 |     63.0000 |     0.6032 |      0.2424 |             0.2857 |          0.2105 |     0.4868 |       -0.0181 |
|   19.0000 |    1899.0000 |     63.0000 |     0.5873 |      0.0000 |             0.0000 |          0.0000 |     0.3700 |        0.0000 |
|   20.0000 |    1920.0000 |     63.0000 |     0.7460 |      0.0000 |             0.0000 |          0.0000 |     0.4273 |        0.0000 |
|   21.0000 |    1941.0000 |     63.0000 |     0.7778 |      0.0000 |             0.0000 |          0.0000 |     0.4375 |       -0.0304 |
|   22.0000 |    1962.0000 |     63.0000 |     0.6984 |      0.0000 |             0.0000 |          0.0000 |     0.4112 |       -0.0310 |
|   23.0000 |    1983.0000 |     63.0000 |     0.5556 |      0.2632 |             0.8333 |          0.1562 |     0.4725 |        0.1224 |
|   24.0000 |    2004.0000 |     63.0000 |     0.4127 |      0.3273 |             0.5294 |          0.2368 |     0.4031 |       -0.0727 |
|   25.0000 |    2025.0000 |     63.0000 |     0.4762 |      0.4407 |             0.4062 |          0.4815 |     0.4741 |       -0.0452 |
|   26.0000 |    2046.0000 |     63.0000 |     0.5397 |      0.4314 |             0.2821 |          0.9167 |     0.5224 |        0.1976 |
|   27.0000 |    2067.0000 |     63.0000 |     0.5238 |      0.4000 |             0.2500 |          1.0000 |     0.5026 |        0.1957 |
|   28.0000 |    2088.0000 |     63.0000 |     0.7778 |      0.4615 |             0.3333 |          0.7500 |     0.6608 |        0.3467 |
|   29.0000 |    2109.0000 |     63.0000 |     0.7778 |      0.2222 |             0.2222 |          0.2222 |     0.5463 |        0.0926 |
|   30.0000 |    2130.0000 |     63.0000 |     0.8413 |      0.0000 |             0.0000 |          0.0000 |     0.4569 |       -0.0294 |
|   31.0000 |    2151.0000 |     63.0000 |     0.7619 |      0.0000 |             0.0000 |          0.0000 |     0.4324 |        0.0000 |
|   32.0000 |    2172.0000 |     63.0000 |     0.7460 |      0.0000 |             0.0000 |          0.0000 |     0.4273 |        0.0000 |
|   33.0000 |    2193.0000 |     63.0000 |     0.7302 |      0.0000 |             0.0000 |          0.0000 |     0.4220 |       -0.0308 |
|   34.0000 |    2214.0000 |     63.0000 |     0.7143 |      0.0000 |             0.0000 |          0.0000 |     0.4167 |       -0.0598 |
|   35.0000 |    2235.0000 |     63.0000 |     0.5873 |      0.0000 |             0.0000 |          0.0000 |     0.3700 |        0.0000 |
|   36.0000 |    2256.0000 |     63.0000 |     0.5556 |      0.2222 |             0.3333 |          0.1667 |     0.4556 |       -0.0426 |
|   37.0000 |    2277.0000 |     63.0000 |     0.5873 |      0.1875 |             0.2308 |          0.1579 |     0.4555 |       -0.0762 |
|   38.0000 |    2298.0000 |     63.0000 |     0.6349 |      0.2581 |             0.2222 |          0.3077 |     0.5080 |        0.0242 |
|   39.0000 |    2319.0000 |     63.0000 |     0.5238 |      0.0625 |             0.0455 |          0.1000 |     0.3717 |       -0.1992 |
|   40.0000 |    2340.0000 |     63.0000 |     0.5556 |      0.0000 |             0.0000 |          0.0000 |     0.3571 |       -0.2216 |
|   41.0000 |    2361.0000 |     63.0000 |     0.6349 |      0.0000 |             0.0000 |          0.0000 |     0.3883 |       -0.1172 |
|   42.0000 |    2382.0000 |     63.0000 |     0.7143 |      0.2500 |             0.1667 |          0.5000 |     0.5368 |        0.1250 |
|   43.0000 |    2403.0000 |     63.0000 |     0.7937 |      0.3810 |             0.6667 |          0.2667 |     0.6286 |        0.2835 |
|   44.0000 |    2424.0000 |     63.0000 |     0.7302 |      0.3704 |             0.8333 |          0.2381 |     0.5993 |        0.2609 |
|   45.0000 |    2445.0000 |     63.0000 |     0.7143 |      0.1000 |             0.5000 |          0.0556 |     0.4651 |        0.0455 |
|   46.0000 |    2466.0000 |     63.0000 |     0.8095 |      0.0000 |             0.0000 |          0.0000 |     0.4474 |       -0.0300 |
|   47.0000 |    2487.0000 |     63.0000 |     0.8413 |      0.0000 |             0.0000 |          0.0000 |     0.4569 |       -0.0294 |
|   48.0000 |    2508.0000 |     63.0000 |     0.6825 |      0.0000 |             0.0000 |          0.0000 |     0.4057 |       -0.1864 |
|   49.0000 |    2529.0000 |     63.0000 |     0.7778 |      0.0000 |             0.0000 |          0.0000 |     0.4375 |       -0.1136 |
|   50.0000 |    2550.0000 |     63.0000 |     0.8889 |      0.0000 |             0.0000 |          0.0000 |     0.4706 |       -0.0576 |
|   51.0000 |    2571.0000 |     63.0000 |     0.8730 |      0.4286 |             0.4286 |          0.4286 |     0.6786 |        0.3571 |
|   52.0000 |    2592.0000 |     63.0000 |     0.8571 |      0.3077 |             0.4000 |          0.2500 |     0.6140 |        0.2327 |
|   53.0000 |    2613.0000 |     63.0000 |     0.7619 |      0.4000 |             0.3333 |          0.5000 |     0.6257 |        0.2588 |
|   54.0000 |    2634.0000 |     63.0000 |     0.7937 |      0.3810 |             0.2500 |          0.8000 |     0.6286 |        0.2958 |
|   55.0000 |    2655.0000 |     63.0000 |     0.6508 |      0.3529 |             0.2143 |          1.0000 |     0.5569 |        0.2326 |
|   56.0000 |    2676.0000 |     63.0000 |     0.7460 |      0.2727 |             0.1875 |          0.5000 |     0.5594 |        0.1558 |

## 8. 分类报告

```
              precision    recall  f1-score   support

       负例(0)       0.80      0.86      0.83      2833
       正例(1)       0.25      0.18      0.21       758

    accuracy                           0.71      3591
   macro avg       0.52      0.52      0.52      3591
weighted avg       0.68      0.71      0.70      3591

```

## 9. 混淆矩阵

|       |   非涨(0) |   大涨(1) |
|:------|--------:|--------:|
| 非涨(0) |    2427 |     406 |
| 大涨(1) |     622 |     136 |

## 10. Top 20 重要特征

| feature               |   importance |
|:----------------------|-------------:|
| lth_sopr_ma30         |          587 |
| vol_volatility_20     |          563 |
| fgi_std30             |          491 |
| buy_pressure_std30    |          484 |
| buy_pressure_std7     |          447 |
| mvrv_std30            |          446 |
| fgi_lag14             |          420 |
| sth_sopr_ma30         |          417 |
| sth_sopr              |          412 |
| rsi_14_std30          |          406 |
| liquidity_proxy       |          388 |
| avg_trade_size_sma_20 |          370 |
| atr_14_std14          |          366 |
| rsi_14_std14          |          365 |
| vix_proxy_change_7    |          364 |
| fgi_std14             |          363 |
| fgi_std7              |          356 |
| rsi_14_std7           |          351 |
| avg_trade_size_sma_10 |          344 |
| flow_momentum_20      |          332 |

## 附录: 完整配置

```yaml
experiment:
  name: weekly_bull_v5
  description: 全面优化版多头 v5：directional标签, purge, 特征选择, 全特征集
  tags:
  - weekly
  - bull
  - binary
  - v5
  - optimized
  category: weekly
data:
  source: binance
  symbol: BTCUSDT
  interval: 1d
  start: '2018-01-01'
  end: '2025-12-31'
  path: data/raw/btc_binance_BTCUSDT_1d.csv
features:
  sets:
  - technical
  - volume
  - flow
  - sentiment
  - onchain
  - market_structure
  - lag_rolling
  drop_na_method: ffill_then_drop
  scaling: null
  selection:
    top_n: 40
label:
  strategy: directional
  T: 7
  X: 0.05
  map:
    0: 0
    1: 0
    2: 1
model:
  type: lightgbm
  params:
    n_estimators: 800
    max_depth: 5
    learning_rate: 0.05
    num_leaves: 24
    subsample: 0.8
    colsample_bytree: 0.7
    min_child_samples: 30
    reg_alpha: 0.2
    reg_lambda: 0.2
    random_state: 42
    verbose: -1
    min_split_gain: 0.005
    auto_scale_pos_weight: true
evaluation:
  method: walk_forward
  init_train: 1500
  oos_window: 63
  step: 21
  metrics:
  - accuracy
  - f1_binary
  - precision_binary
  - recall_binary
  - f1_macro
  - cohen_kappa
  purge_gap: 7
seed: 42

```