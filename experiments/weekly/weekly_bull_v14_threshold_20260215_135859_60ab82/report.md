# 实验报告: weekly_bull_v14_threshold_20260215_135859_60ab82

**生成时间**: 2026-02-15 14:00:15

## 1. 实验概要

| 项目 | 值 |
|------|------|
| 实验名称 | weekly_bull_v14_threshold |
| 描述 | Bull v14: T=21 + FGI + 概率阈值优化 |
| 标签 | ['weekly', 'bull', 'binary', 'v14', 'threshold_opt'] |
| Git Commit | 02d44d5 |
| Git Branch | main |
| 耗时 | Nones |
| 随机种子 | 42 |

## 2. 数据配置

- **数据源**: binance
- **交易对**: BTCUSDT
- **周期**: 1d
- **时间范围**: 2018-01-01 ~ 2025-12-31
- **数据文件**: `data/raw/btc_binance_BTCUSDT_1d.csv`

## 3. 特征配置

- **特征集**: ['technical', 'volume', 'flow', 'market_structure', 'external_fgi']
- **总特征数**: 137
- **NaN处理**: ffill_then_drop

## 4. 标签配置

- **策略**: reversal
- **窗口 T**: 21 天
- **阈值 X**: 0.05 (5%)

## 5. 模型配置

- **类型**: lightgbm
- **参数**:
  - n_estimators: 500
  - max_depth: 6
  - learning_rate: 0.05
  - num_leaves: 31
  - subsample: 0.8
  - colsample_bytree: 0.8
  - min_child_samples: 20
  - reg_alpha: 0.1
  - reg_lambda: 0.1
  - random_state: 42
  - verbose: -1
  - auto_scale_pos_weight: True

## 6. 评估结果（汇总）

| 指标               |      值 |
|:-----------------|-------:|
| accuracy         | 0.5608 |
| f1_binary        | 0.6463 |
| precision_binary | 0.6085 |
| recall_binary    | 0.6891 |
| f1_macro         | 0.5336 |
| cohen_kappa      | 0.0731 |

## 7. Walk-Forward Fold 详情

- **方法**: walk_forward
- **初始训练集**: 1500
- **OOS窗口**: 63
- **步进**: 21
- **总 Fold 数**: 57

|   fold_id |   train_size |   test_size |   accuracy |   f1_binary |   precision_binary |   recall_binary |   f1_macro |   cohen_kappa |
|----------:|-------------:|------------:|-----------:|------------:|-------------------:|----------------:|-----------:|--------------:|
|    0.0000 |    1500.0000 |     63.0000 |     0.7143 |      0.8125 |             0.7091 |          0.9512 |     0.6062 |        0.2627 |
|    1.0000 |    1521.0000 |     63.0000 |     0.6032 |      0.6914 |             0.5714 |          0.8750 |     0.5679 |        0.1993 |
|    2.0000 |    1542.0000 |     63.0000 |     0.6825 |      0.7436 |             0.6591 |          0.8529 |     0.6635 |        0.3444 |
|    3.0000 |    1563.0000 |     63.0000 |     0.5238 |      0.6053 |             0.4600 |          0.8846 |     0.5026 |        0.1362 |
|    4.0000 |    1584.0000 |     63.0000 |     0.5714 |      0.7216 |             0.6364 |          0.8333 |     0.3953 |       -0.1408 |
|    5.0000 |    1605.0000 |     63.0000 |     0.5079 |      0.5974 |             0.7188 |          0.5111 |     0.4824 |        0.0091 |
|    6.0000 |    1626.0000 |     63.0000 |     0.4444 |      0.4262 |             1.0000 |          0.2708 |     0.4439 |        0.1503 |
|    7.0000 |    1647.0000 |     63.0000 |     0.3810 |      0.2909 |             1.0000 |          0.1702 |     0.3708 |        0.0944 |
|    8.0000 |    1668.0000 |     63.0000 |     0.6508 |      0.7660 |             0.7826 |          0.7500 |     0.5392 |        0.0797 |
|    9.0000 |    1689.0000 |     63.0000 |     0.5873 |      0.7045 |             0.6458 |          0.7750 |     0.5102 |        0.0387 |
|   10.0000 |    1710.0000 |     63.0000 |     0.3968 |      0.5581 |             0.3871 |          1.0000 |     0.3041 |        0.0197 |
|   11.0000 |    1731.0000 |     63.0000 |     0.5079 |      0.6076 |             0.4444 |          0.9600 |     0.4740 |        0.1423 |
|   12.0000 |    1752.0000 |     63.0000 |     0.4762 |      0.6024 |             0.4386 |          0.9615 |     0.4175 |        0.0821 |
|   13.0000 |    1773.0000 |     63.0000 |     0.7143 |      0.7097 |             0.5641 |          0.9565 |     0.7142 |        0.4631 |
|   14.0000 |    1794.0000 |     63.0000 |     0.7143 |      0.4000 |             0.2609 |          0.8571 |     0.6062 |        0.2768 |
|   15.0000 |    1815.0000 |     63.0000 |     0.7778 |      0.6316 |             0.5455 |          0.7500 |     0.7362 |        0.4781 |
|   16.0000 |    1836.0000 |     63.0000 |     0.7619 |      0.7826 |             0.7714 |          0.7941 |     0.7597 |        0.5196 |
|   17.0000 |    1857.0000 |     63.0000 |     0.8730 |      0.9310 |             0.8710 |          1.0000 |     0.5655 |        0.1765 |
|   18.0000 |    1878.0000 |     63.0000 |     0.6508 |      0.7708 |             0.9737 |          0.6379 |     0.5188 |        0.1549 |
|   19.0000 |    1899.0000 |     63.0000 |     0.3492 |      0.4938 |             1.0000 |          0.3279 |     0.2914 |        0.0300 |
|   20.0000 |    1920.0000 |     63.0000 |     0.2698 |      0.2333 |             1.0000 |          0.1321 |     0.2682 |        0.0461 |
|   21.0000 |    1941.0000 |     63.0000 |     0.5873 |      0.7234 |             0.7556 |          0.6939 |     0.4555 |       -0.0833 |
|   22.0000 |    1962.0000 |     63.0000 |     0.6984 |      0.8224 |             0.6984 |          1.0000 |     0.4112 |        0.0000 |
|   23.0000 |    1983.0000 |     63.0000 |     0.8095 |      0.8947 |             0.8226 |          0.9808 |     0.4474 |       -0.0300 |
|   24.0000 |    2004.0000 |     63.0000 |     0.7460 |      0.8491 |             0.8491 |          0.8491 |     0.5245 |        0.0491 |
|   25.0000 |    2025.0000 |     63.0000 |     0.6032 |      0.7475 |             0.7255 |          0.7708 |     0.4108 |       -0.1745 |
|   26.0000 |    2046.0000 |     63.0000 |     0.5397 |      0.6027 |             0.5238 |          0.7097 |     0.5278 |        0.0842 |
|   27.0000 |    2067.0000 |     63.0000 |     0.4762 |      0.3265 |             0.6154 |          0.2222 |     0.4490 |        0.0335 |
|   28.0000 |    2088.0000 |     63.0000 |     0.5873 |      0.5357 |             0.5556 |          0.5172 |     0.5821 |        0.1651 |
|   29.0000 |    2109.0000 |     63.0000 |     0.5556 |      0.4815 |             0.5417 |          0.4333 |     0.5463 |        0.1009 |
|   30.0000 |    2130.0000 |     63.0000 |     0.4444 |      0.6154 |             0.4444 |          1.0000 |     0.3077 |        0.0000 |
|   31.0000 |    2151.0000 |     63.0000 |     0.6508 |      0.7317 |             0.5769 |          1.0000 |     0.6159 |        0.3226 |
|   32.0000 |    2172.0000 |     63.0000 |     0.6508 |      0.7843 |             0.6452 |          1.0000 |     0.4338 |        0.0546 |
|   33.0000 |    2193.0000 |     63.0000 |     0.7143 |      0.8163 |             0.6897 |          1.0000 |     0.5867 |        0.2608 |
|   34.0000 |    2214.0000 |     63.0000 |     0.7778 |      0.8679 |             0.7931 |          0.9583 |     0.5840 |        0.2054 |
|   35.0000 |    2235.0000 |     63.0000 |     0.5873 |      0.6829 |             1.0000 |          0.5185 |     0.5460 |        0.2353 |
|   36.0000 |    2256.0000 |     63.0000 |     0.3492 |      0.4225 |             0.8824 |          0.2778 |     0.3385 |        0.0205 |
|   37.0000 |    2277.0000 |     63.0000 |     0.1746 |      0.1613 |             1.0000 |          0.0877 |     0.1744 |        0.0180 |
|   38.0000 |    2298.0000 |     63.0000 |     0.6667 |      0.7921 |             0.7547 |          0.8333 |     0.4760 |       -0.0376 |
|   39.0000 |    2319.0000 |     63.0000 |     0.6508 |      0.7885 |             0.6508 |          1.0000 |     0.3942 |        0.0000 |
|   40.0000 |    2340.0000 |     63.0000 |     0.3968 |      0.5581 |             0.3871 |          1.0000 |     0.3041 |        0.0197 |
|   41.0000 |    2361.0000 |     63.0000 |     0.2857 |      0.4444 |             0.2857 |          1.0000 |     0.2222 |        0.0000 |
|   42.0000 |    2382.0000 |     63.0000 |     0.2698 |      0.3429 |             0.2069 |          1.0000 |     0.2607 |        0.0398 |
|   43.0000 |    2403.0000 |     63.0000 |     0.5079 |      0.6667 |             0.5000 |          1.0000 |     0.3636 |        0.0308 |
|   44.0000 |    2424.0000 |     63.0000 |     0.5397 |      0.6813 |             0.6889 |          0.6739 |     0.4264 |       -0.1469 |
|   45.0000 |    2445.0000 |     63.0000 |     0.4444 |      0.5783 |             0.7273 |          0.4800 |     0.3822 |       -0.1431 |
|   46.0000 |    2466.0000 |     63.0000 |     0.6984 |      0.6667 |             1.0000 |          0.5000 |     0.6957 |        0.4425 |
|   47.0000 |    2487.0000 |     63.0000 |     0.4603 |      0.3462 |             0.5625 |          0.2500 |     0.4433 |       -0.0085 |
|   48.0000 |    2508.0000 |     63.0000 |     0.6032 |      0.2424 |             0.8000 |          0.1429 |     0.4868 |        0.1245 |
|   49.0000 |    2529.0000 |     63.0000 |     0.6190 |      0.2941 |             0.8333 |          0.1786 |     0.5166 |        0.1628 |
|   50.0000 |    2550.0000 |     63.0000 |     0.6349 |      0.4651 |             0.4348 |          0.5000 |     0.5940 |        0.1901 |
|   51.0000 |    2571.0000 |     63.0000 |     0.6825 |      0.7619 |             0.6809 |          0.8649 |     0.6429 |        0.3054 |
|   52.0000 |    2592.0000 |     63.0000 |     0.5873 |      0.6667 |             0.6190 |          0.7222 |     0.5625 |        0.1333 |
|   53.0000 |    2613.0000 |     63.0000 |     0.4921 |      0.6098 |             0.4386 |          1.0000 |     0.4412 |        0.1295 |
|   54.0000 |    2634.0000 |     63.0000 |     0.3016 |      0.3714 |             0.2281 |          1.0000 |     0.2929 |        0.0533 |
|   55.0000 |    2655.0000 |     63.0000 |     0.3810 |      0.4935 |             0.3276 |          1.0000 |     0.3488 |        0.0718 |
|   56.0000 |    2676.0000 |     63.0000 |     0.6349 |      0.7473 |             0.5965 |          1.0000 |     0.5451 |        0.2197 |

## 8. 分类报告

```
              precision    recall  f1-score   support

       负例(0)       0.47      0.38      0.42      1500
       正例(1)       0.61      0.69      0.65      2091

    accuracy                           0.56      3591
   macro avg       0.54      0.54      0.53      3591
weighted avg       0.55      0.56      0.55      3591

```

## 9. 混淆矩阵

|       |   非涨(0) |   大涨(1) |
|:------|--------:|--------:|
| 非涨(0) |     573 |     927 |
| 大涨(1) |     650 |    1441 |

## 10. Top 20 重要特征

| feature           |   importance |
|:------------------|-------------:|
| vol_volatility_20 |          259 |
| sma_cross_50_200  |          221 |
| obv               |          202 |
| price_vs_sma_50   |          189 |
| rsi_28            |          186 |
| ext_fgi_std_14    |          184 |
| low_50d_dist      |          181 |
| vol_volatility_10 |          174 |
| price_vs_sma_200  |          159 |
| vol_price_corr_10 |          157 |
| sma_200           |          156 |
| high_21d_dist     |          153 |
| flow_momentum_20  |          147 |
| atr_21            |          146 |
| return_1d         |          145 |
| atr_pct_21        |          139 |
| trades_sma_20     |          138 |
| cvd_change_21     |          137 |
| vol_price_corr_20 |          135 |
| return_3d         |          133 |

## 附录: 完整配置

```yaml
experiment:
  name: weekly_bull_v14_threshold
  description: 'Bull v14: T=21 + FGI + 概率阈值优化'
  tags:
  - weekly
  - bull
  - binary
  - v14
  - threshold_opt
  category: weekly
data:
  source: binance
  symbol: BTCUSDT
  interval: 1d
  start: '2018-01-01'
  end: '2025-12-31'
  path: data/raw/btc_binance_BTCUSDT_1d.csv
features:
  sets:
  - technical
  - volume
  - flow
  - market_structure
  - external_fgi
  drop_na_method: ffill_then_drop
  scaling: null
label:
  strategy: reversal
  T: 21
  X: 0.05
  map:
    0: 0
    1: 0
    2: 1
model:
  type: lightgbm
  params:
    n_estimators: 500
    max_depth: 6
    learning_rate: 0.05
    num_leaves: 31
    subsample: 0.8
    colsample_bytree: 0.8
    min_child_samples: 20
    reg_alpha: 0.1
    reg_lambda: 0.1
    random_state: 42
    verbose: -1
    auto_scale_pos_weight: true
evaluation:
  method: walk_forward
  init_train: 1500
  oos_window: 63
  step: 21
  metrics:
  - accuracy
  - f1_binary
  - precision_binary
  - recall_binary
  - f1_macro
  - cohen_kappa
  threshold_optimize: true
  threshold_metric: kappa
  threshold_val_ratio: 0.15
seed: 42

```