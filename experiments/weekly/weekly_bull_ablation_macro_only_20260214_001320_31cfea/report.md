# 实验报告: weekly_bull_ablation_macro_only_20260214_001320_31cfea

**生成时间**: 2026-02-14 00:15:06

## 1. 实验概要

| 项目 | 值 |
|------|------|
| 实验名称 | weekly_bull_ablation_macro_only |
| 描述 | 消融实验: 基线 + 仅宏观因子 |
| 标签 | ['weekly', 'bull', 'binary', 'ablation', 'macro'] |
| Git Commit | 41bd739 |
| Git Branch | main |
| 耗时 | Nones |
| 随机种子 | 42 |

## 2. 数据配置

- **数据源**: binance
- **交易对**: BTCUSDT
- **周期**: 1d
- **时间范围**: 2018-01-01 ~ 2025-12-31
- **数据文件**: `data/raw/btc_binance_BTCUSDT_1d.csv`

## 3. 特征配置

- **特征集**: ['technical', 'volume', 'flow', 'market_structure', 'external_macro']
- **总特征数**: 193
- **NaN处理**: ffill_then_drop

## 4. 标签配置

- **策略**: reversal
- **窗口 T**: 14 天
- **阈值 X**: 0.05 (5%)

## 5. 模型配置

- **类型**: lightgbm
- **参数**:
  - n_estimators: 500
  - max_depth: 6
  - learning_rate: 0.05
  - num_leaves: 31
  - subsample: 0.8
  - colsample_bytree: 0.8
  - min_child_samples: 20
  - reg_alpha: 0.1
  - reg_lambda: 0.1
  - random_state: 42
  - verbose: -1
  - auto_scale_pos_weight: True

## 6. 评估结果（汇总）

| 指标               |      值 |
|:-----------------|-------:|
| accuracy         | 0.5141 |
| f1_binary        | 0.3648 |
| precision_binary | 0.4758 |
| recall_binary    | 0.2957 |
| f1_macro         | 0.4857 |
| cohen_kappa      | 0.0049 |

## 7. Walk-Forward Fold 详情

- **方法**: walk_forward
- **初始训练集**: 1500
- **OOS窗口**: 63
- **步进**: 21
- **总 Fold 数**: 57

|   fold_id |   train_size |   test_size |   accuracy |   f1_binary |   precision_binary |   recall_binary |   f1_macro |   cohen_kappa |
|----------:|-------------:|------------:|-----------:|------------:|-------------------:|----------------:|-----------:|--------------:|
|    0.0000 |    1500.0000 |     63.0000 |     0.4921 |      0.3043 |             0.7778 |          0.1892 |     0.4522 |        0.0968 |
|    1.0000 |    1521.0000 |     63.0000 |     0.6349 |      0.3030 |             0.8333 |          0.1852 |     0.5279 |        0.1744 |
|    2.0000 |    1542.0000 |     63.0000 |     0.6190 |      0.2000 |             0.6000 |          0.1200 |     0.4750 |        0.0780 |
|    3.0000 |    1563.0000 |     63.0000 |     0.6032 |      0.3902 |             0.2857 |          0.6154 |     0.5481 |        0.1509 |
|    4.0000 |    1584.0000 |     63.0000 |     0.4603 |      0.1500 |             0.3000 |          0.1000 |     0.3773 |       -0.1156 |
|    5.0000 |    1605.0000 |     63.0000 |     0.5238 |      0.3182 |             0.5000 |          0.2333 |     0.4762 |        0.0217 |
|    6.0000 |    1626.0000 |     63.0000 |     0.4762 |      0.1081 |             1.0000 |          0.0571 |     0.3687 |        0.0511 |
|    7.0000 |    1647.0000 |     63.0000 |     0.6032 |      0.3902 |             0.6667 |          0.2759 |     0.5481 |        0.1653 |
|    8.0000 |    1668.0000 |     63.0000 |     0.6032 |      0.5283 |             0.8235 |          0.3889 |     0.5929 |        0.2553 |
|    9.0000 |    1689.0000 |     63.0000 |     0.5714 |      0.4490 |             0.6875 |          0.3333 |     0.5492 |        0.1625 |
|   10.0000 |    1710.0000 |     63.0000 |     0.4603 |      0.0556 |             0.0714 |          0.0455 |     0.3389 |       -0.2966 |
|   11.0000 |    1731.0000 |     63.0000 |     0.4762 |      0.1081 |             0.1111 |          0.1053 |     0.3687 |       -0.2623 |
|   12.0000 |    1752.0000 |     63.0000 |     0.5079 |      0.2439 |             0.2273 |          0.2632 |     0.4396 |       -0.1179 |
|   13.0000 |    1773.0000 |     63.0000 |     0.6984 |      0.2400 |             0.3333 |          0.1875 |     0.5259 |        0.0699 |
|   14.0000 |    1794.0000 |     63.0000 |     0.8730 |      0.3333 |             0.3333 |          0.3333 |     0.6316 |        0.2632 |
|   15.0000 |    1815.0000 |     63.0000 |     0.7619 |      0.4000 |             0.4167 |          0.3846 |     0.6257 |        0.2518 |
|   16.0000 |    1836.0000 |     63.0000 |     0.6349 |      0.3030 |             0.6250 |          0.2000 |     0.5279 |        0.1370 |
|   17.0000 |    1857.0000 |     63.0000 |     0.4762 |      0.3529 |             0.7500 |          0.2308 |     0.4565 |        0.0870 |
|   18.0000 |    1878.0000 |     63.0000 |     0.3492 |      0.1277 |             1.0000 |          0.0682 |     0.3043 |        0.0423 |
|   19.0000 |    1899.0000 |     63.0000 |     0.3016 |      0.1538 |             1.0000 |          0.0833 |     0.2796 |        0.0415 |
|   20.0000 |    1920.0000 |     63.0000 |     0.3968 |      0.0952 |             1.0000 |          0.0500 |     0.3214 |        0.0370 |
|   21.0000 |    1941.0000 |     63.0000 |     0.4444 |      0.0541 |             1.0000 |          0.0278 |     0.3304 |        0.0239 |
|   22.0000 |    1962.0000 |     63.0000 |     0.5079 |      0.5079 |             0.5161 |          0.5000 |     0.5079 |        0.0161 |
|   23.0000 |    1983.0000 |     63.0000 |     0.3016 |      0.2414 |             0.5833 |          0.1522 |     0.2972 |       -0.0871 |
|   24.0000 |    2004.0000 |     63.0000 |     0.3016 |      0.3125 |             0.6667 |          0.2041 |     0.3014 |       -0.0820 |
|   25.0000 |    2025.0000 |     63.0000 |     0.3810 |      0.3158 |             1.0000 |          0.1875 |     0.3753 |        0.0990 |
|   26.0000 |    2046.0000 |     63.0000 |     0.4127 |      0.4789 |             0.4146 |          0.5667 |     0.4031 |       -0.1580 |
|   27.0000 |    2067.0000 |     63.0000 |     0.4921 |      0.0000 |             0.0000 |          0.0000 |     0.3298 |       -0.0633 |
|   28.0000 |    2088.0000 |     63.0000 |     0.5714 |      0.5424 |             0.4444 |          0.6957 |     0.5697 |        0.1747 |
|   29.0000 |    2109.0000 |     63.0000 |     0.5397 |      0.0645 |             0.0909 |          0.0500 |     0.3796 |       -0.2075 |
|   30.0000 |    2130.0000 |     63.0000 |     0.3016 |      0.4634 |             0.3016 |          1.0000 |     0.2317 |        0.0000 |
|   31.0000 |    2151.0000 |     63.0000 |     0.6825 |      0.6154 |             0.5000 |          0.8000 |     0.6726 |        0.3687 |
|   32.0000 |    2172.0000 |     63.0000 |     0.6825 |      0.6154 |             0.8421 |          0.4848 |     0.6726 |        0.3769 |
|   33.0000 |    2193.0000 |     63.0000 |     0.6667 |      0.7470 |             0.6458 |          0.8857 |     0.6293 |        0.2921 |
|   34.0000 |    2214.0000 |     63.0000 |     0.6190 |      0.6571 |             0.7931 |          0.5610 |     0.6143 |        0.2559 |
|   35.0000 |    2235.0000 |     63.0000 |     0.2698 |      0.1481 |             0.8000 |          0.0816 |     0.2546 |        0.0048 |
|   36.0000 |    2256.0000 |     63.0000 |     0.2222 |      0.0392 |             1.0000 |          0.0200 |     0.1929 |        0.0084 |
|   37.0000 |    2277.0000 |     63.0000 |     0.1746 |      0.0714 |             1.0000 |          0.0370 |     0.1643 |        0.0109 |
|   38.0000 |    2298.0000 |     63.0000 |     0.5238 |      0.5946 |             0.7097 |          0.5116 |     0.5088 |        0.0531 |
|   39.0000 |    2319.0000 |     63.0000 |     0.4921 |      0.5000 |             0.5926 |          0.4324 |     0.4919 |        0.0088 |
|   40.0000 |    2340.0000 |     63.0000 |     0.3968 |      0.5250 |             0.3621 |          0.9545 |     0.3495 |        0.0378 |
|   41.0000 |    2361.0000 |     63.0000 |     0.3333 |      0.4615 |             0.3000 |          1.0000 |     0.2933 |        0.0392 |
|   42.0000 |    2382.0000 |     63.0000 |     0.4762 |      0.4211 |             0.2667 |          1.0000 |     0.4714 |        0.1720 |
|   43.0000 |    2403.0000 |     63.0000 |     0.5079 |      0.5974 |             0.4423 |          0.9200 |     0.4824 |        0.1324 |
|   44.0000 |    2424.0000 |     63.0000 |     0.4286 |      0.2800 |             0.5833 |          0.1842 |     0.4032 |       -0.0134 |
|   45.0000 |    2445.0000 |     63.0000 |     0.3968 |      0.1739 |             1.0000 |          0.0952 |     0.3495 |        0.0656 |
|   46.0000 |    2466.0000 |     63.0000 |     0.5397 |      0.2564 |             1.0000 |          0.1471 |     0.4615 |        0.1370 |
|   47.0000 |    2487.0000 |     63.0000 |     0.6190 |      0.4000 |             0.8889 |          0.2581 |     0.5605 |        0.2294 |
|   48.0000 |    2508.0000 |     63.0000 |     0.6667 |      0.1600 |             1.0000 |          0.0870 |     0.4760 |        0.1079 |
|   49.0000 |    2529.0000 |     63.0000 |     0.6349 |      0.1481 |             1.0000 |          0.0800 |     0.4579 |        0.0949 |
|   50.0000 |    2550.0000 |     63.0000 |     0.8095 |      0.5000 |             0.8571 |          0.3529 |     0.6912 |        0.4066 |
|   51.0000 |    2571.0000 |     63.0000 |     0.5556 |      0.1765 |             0.5000 |          0.1071 |     0.4361 |        0.0233 |
|   52.0000 |    2592.0000 |     63.0000 |     0.6349 |      0.4390 |             0.6429 |          0.3333 |     0.5842 |        0.2069 |
|   53.0000 |    2613.0000 |     63.0000 |     0.4603 |      0.2609 |             0.2222 |          0.3158 |     0.4179 |       -0.1442 |
|   54.0000 |    2634.0000 |     63.0000 |     0.4603 |      0.4138 |             0.2667 |          0.9231 |     0.4569 |        0.1377 |
|   55.0000 |    2655.0000 |     63.0000 |     0.4921 |      0.4074 |             0.2619 |          0.9167 |     0.4815 |        0.1579 |
|   56.0000 |    2676.0000 |     63.0000 |     0.7778 |      0.6957 |             0.8421 |          0.5926 |     0.7603 |        0.5288 |

## 8. 分类报告

```
              precision    recall  f1-score   support

       负例(0)       0.53      0.71      0.61      1897
       正例(1)       0.48      0.30      0.36      1694

    accuracy                           0.51      3591
   macro avg       0.50      0.50      0.49      3591
weighted avg       0.50      0.51      0.49      3591

```

## 9. 混淆矩阵

|       |   非涨(0) |   大涨(1) |
|:------|--------:|--------:|
| 非涨(0) |    1345 |     552 |
| 大涨(1) |    1193 |     501 |

## 10. Top 20 重要特征

| feature              |   importance |
|:---------------------|-------------:|
| ext_btc_tnx_corr_60d |          184 |
| ext_btc_vix_corr_60d |          171 |
| vol_volatility_20    |          161 |
| price_vs_sma_50      |          156 |
| sma_cross_50_200     |          155 |
| ext_btc_tnx_corr_20d |          141 |
| ext_dxy_vol_20d      |          133 |
| ext_btc_spx_corr_60d |          128 |
| vol_price_corr_20    |          126 |
| low_50d_dist         |          125 |
| ext_btc_dxy_corr_60d |          119 |
| atr_pct_21           |          118 |
| flow_momentum_20     |          118 |
| ext_gold_vol_20d     |          118 |
| ext_vix_vol_20d      |          114 |
| ext_btc_dxy_corr_20d |          110 |
| macd_hist            |          109 |
| ext_vix              |          107 |
| ext_tnx              |          106 |
| return_3d            |          105 |

## 附录: 完整配置

```yaml
experiment:
  name: weekly_bull_ablation_macro_only
  description: '消融实验: 基线 + 仅宏观因子'
  tags:
  - weekly
  - bull
  - binary
  - ablation
  - macro
  category: weekly
data:
  source: binance
  symbol: BTCUSDT
  interval: 1d
  start: '2018-01-01'
  end: '2025-12-31'
  path: data/raw/btc_binance_BTCUSDT_1d.csv
features:
  sets:
  - technical
  - volume
  - flow
  - market_structure
  - external_macro
  drop_na_method: ffill_then_drop
  scaling: null
label:
  strategy: reversal
  T: 14
  X: 0.05
  map:
    0: 0
    1: 0
    2: 1
model:
  type: lightgbm
  params:
    n_estimators: 500
    max_depth: 6
    learning_rate: 0.05
    num_leaves: 31
    subsample: 0.8
    colsample_bytree: 0.8
    min_child_samples: 20
    reg_alpha: 0.1
    reg_lambda: 0.1
    random_state: 42
    verbose: -1
    auto_scale_pos_weight: true
evaluation:
  method: walk_forward
  init_train: 1500
  oos_window: 63
  step: 21
  metrics:
  - accuracy
  - f1_binary
  - precision_binary
  - recall_binary
  - f1_macro
  - cohen_kappa
seed: 42

```