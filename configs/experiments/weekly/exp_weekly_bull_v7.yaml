# ============================================================
# Weekly Bull Model v7: å¤–éƒ¨æ•°æ® + Triple Barrier
# ç›¸æ¯” v6 çš„æ”¹è¿›:
#   1. å¼•å…¥çœŸå®å¤–éƒ¨æ•°æ® (FGI, å®è§‚å› å­, Funding Rate, L/S Ratio)
#      - v6 çš„ onchain/sentiment å…¨æ˜¯ä»·æ ¼ä»£ç†æŒ‡æ ‡ï¼Œä¸ä»·æ ¼é«˜åº¦å…±çº¿
#      - v7 çš„ external ç‰¹å¾æ˜¯ç‹¬ç«‹ä¿¡æ¯æºï¼Œæ‰“ç ´ä¿¡æ¯é‡ç“¶é¢ˆ
#   2. Triple Barrier æ ‡ç­¾æ›¿ä»£ reversal
#      - reversal çœ‹çª—å£å†…æå€¼ï¼Œå®¹æ˜“åŒæ—¶è§¦å‘æ¶¨è·Œ
#      - triple_barrier æœ‰æ­¢ç›ˆ/æ­¢æŸ/è¶…æ—¶æ¦‚å¿µï¼Œæ›´è´´è¿‘çœŸå®äº¤æ˜“
#   3. ä¿ç•™ market_structureï¼ˆv6 ä¸­ Bear æ¨¡å‹æœ‰æå‡ï¼‰
#   4. åŠ¨æ€é˜ˆå€¼ (ATR-based)ï¼šé«˜æ³¢åŠ¨æœŸè‡ªåŠ¨æ”¾å®½é˜ˆå€¼
# ============================================================
experiment:
  name: "weekly_bull_v7"
  description: "Bull v7: å¤–éƒ¨æ•°æ® + Triple Barrier + åŠ¨æ€é˜ˆå€¼"
  tags: ["weekly", "bull", "binary", "v7", "external", "triple_barrier"]
  category: "weekly"

data:
  path: "data/raw/btc_binance_BTCUSDT_1d.csv"

features:
  sets:
    - technical
    - volume
    - flow
    - market_structure
    - external      # ğŸ†• çœŸå®å¤–éƒ¨æ•°æ®
  drop_na_method: "ffill_then_drop"

label:
  strategy: "triple_barrier"   # ğŸ†• Triple Barrier
  T: 14
  X: 0.05                     # å›ºå®šé˜ˆå€¼ fallback
  dynamic_threshold: true      # ğŸ†• ä½¿ç”¨ ATR åŠ¨æ€é˜ˆå€¼
  atr_window: 14
  atr_multiplier: 2.0
  sl_ratio: 1.0               # å¯¹ç§°æ­¢ç›ˆæ­¢æŸ
  map:
    0: 0    # æ­¢æŸ â†’ 0 (éå¤šå¤´æœºä¼š)
    1: 0    # è¶…æ—¶ â†’ 0 (éå¤šå¤´æœºä¼š)
    2: 1    # æ­¢ç›ˆ â†’ 1 (å¤šå¤´æœºä¼š)

model:
  type: "lightgbm"
  params:
    n_estimators: 1200
    max_depth: 5
    learning_rate: 0.03        # ğŸ†• æ›´ä½å­¦ä¹ ç‡ + æ›´å¤šæ ‘
    num_leaves: 24
    subsample: 0.8
    colsample_bytree: 0.7     # ğŸ†• ç•¥é™ï¼Œå¢åŠ å¤šæ ·æ€§
    min_child_samples: 25     # ğŸ†• ç•¥å‡ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆæ–°ç‰¹å¾
    reg_alpha: 0.2
    reg_lambda: 0.2
    min_split_gain: 0.005
    random_state: 42
    verbose: -1
    auto_scale_pos_weight: true
    early_stopping_rounds: 50  # ğŸ†• å¯ç”¨æ—©åœ

evaluation:
  method: "walk_forward"
  init_train: 1500
  oos_window: 63
  step: 21
  purge_gap: 14               # ğŸ†• é˜²æ­¢æ ‡ç­¾æ³„æ¼
  metrics:
    - accuracy
    - f1_binary
    - precision_binary
    - recall_binary
    - f1_macro
    - cohen_kappa
